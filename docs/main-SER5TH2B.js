import{a as _}from"./chunk-I4YD4NEX.js";import{a as st}from"./chunk-YSJPQJIY.js";import"./chunk-WPQESNG4.js";import{A as R,k as rt,r as nt,u as S,v as it,w as at,y as pt,z as ct}from"./chunk-AMFU7SSY.js";import{Ab as Y,B as O,Bb as $,Ca as G,Cb as tt,Db as x,Fb as et,Gb as ot,Ha as s,Ia as m,J as H,Ja as f,M as i,Na as q,V as N,Ya as b,Z as P,Za as z,_a as X,ba as g,ga as k,gb as B,j as u,jb as W,k as w,l as T,m as j,oa as d,rb as Z,sa as U,tb as J,ua as L,v as C,wb as K,xb as Q,zb as V}from"./chunk-LDLCI6JG.js";import{a as h}from"./chunk-QEZ3K4DX.js";var F=(e,o)=>{let t=i(_),r=i(x),n=t.isAuthenticated();return n&&r.navigate([""]),!n};var M=(e,o)=>i(_).isAuthenticated();var mt=[{path:"",loadChildren:()=>import("./chunk-SJMU2OAR.js").then(e=>e.routes),canActivate:[M],canMatch:[M]},{path:"auth",loadChildren:()=>import("./chunk-MSLKUBHE.js").then(e=>e.routes),canActivate:[F],canMatch:[F]},{path:"**",redirectTo:"auth"}];var c=class e{_dataHttpRequests=g([]);dataHttpRequests=this._dataHttpRequests.asReadonly();addOrUdpateHttpRequest(o){this._dataHttpRequests.update(t=>{let r=t.findIndex(n=>n.context.id===o.context.id);return o.state==="complete"&&t[r].state==="error"?[...t]:r===-1?[...t,o]:(t[r]=o,[...t])})}getHttpRequestById(o){return this._dataHttpRequests().find(t=>t.context.id===o)}getContextFromRequest(o){let t=o.context.get(it);return h(h({},S),t)}static \u0275fac=function(t){return new(t||e)};static \u0275prov=H({token:e,factory:e.\u0275fac,providedIn:"root"})};var E=class e{_activeModal=i(nt);data=g(null);clicked=P();close(){this.clicked.emit("closed"),this._activeModal.close("Close click")}dismiss(){this._activeModal.dismiss("Cross click")}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=d({type:e,selectors:[["core-http-error-modal"]],outputs:{clicked:"clicked"},decls:11,vars:2,consts:[[1,"modal-header","bg-danger","text-white"],[1,"modal-title"],[1,"bi","bi-x-circle-fill"],["type","button","aria-label","Close",1,"btn-close","btn-close-white",3,"click"],[1,"modal-body","text-center"],[1,"mt-3"],[1,"modal-footer"],["type","button",1,"btn","btn-danger",3,"click"]],template:function(t,r){if(t&1&&(s(0,"div",0)(1,"h4",1),f(2,"i",2),b(3),m(),s(4,"button",3),q("click",function(){return r.dismiss()}),m()(),s(5,"div",4)(6,"p",5),b(7),m()(),s(8,"div",6)(9,"button",7),q("click",function(){return r.close()}),b(10,"Close"),m()()),t&2){let n,a;k(3),X(" Error: ",(n=r.data())==null?null:n.title," "),k(4),z((a=r.data())==null?null:a.message)}},encapsulation:2})};var v=class e{_context=S;_req;_destroyRef=i(N);_configService=i(R);_modalService=i(at);setContext(o){this._context=o}setRequest(o){this._req=o}shouldExecuteAction(o,t,r=!0){let{actionsForAnHttpError:n}=this._context;if(!n)return r;if(Array.isArray(n))return n.includes(o);let a=n[o];if(!a)return r;let{onlyForStatusCodes:p,excludeStatusCodes:l}=a;return Array.isArray(p)&&p.includes(t)?!0:(Array.isArray(l)&&l.includes(t),!1)}executeActions(o,t){if(!this.shouldExecuteAction("modal",o,!0))return;let r=this._configService.config(),n=null,a={};if(t){let{databaseError:{context:p,field:{name:l,args:D},error_type:ht}}=t;a=D,n=r.errors.validations?.[p]?.[l]?.[ht]||null}else n=r.errors.httpStatus[o];n||(n=r.errors.httpStatus.generic),this._modalService.open({component:E,destroyRef:this._destroyRef,args:{data:h({},n.data.modal),clicked:p=>{}},options:{animation:!0}})}static \u0275fac=function(t){return new(t||e)};static \u0275prov=H({token:e,factory:e.\u0275fac,providedIn:"root"})};var Ct=pt.timeoutSeconds;function ut(e,o){let t=i(c),r=i(v),n=t.getContextFromRequest(e);return r.setRequest(e),r.setContext(n),o(e).pipe(j(Ct*1e3),C(a=>a instanceof T?(r.executeActions(Q.RequestTimeout),t.addOrUdpateHttpRequest({state:"error",timeoutError:a,req:e,context:n}),u(()=>a)):u(()=>a)))}function dt(e,o){let t=i(x),r=i(c),n=i(v),a=r.getContextFromRequest(e);return n.setRequest(e),n.setContext(a),o(e).pipe(C(p=>{if(!(p instanceof K))return u(()=>p);let{status:l,databaseErrorResponse:D=null}=p.error||{};return n.executeActions(l,D),r.addOrUdpateHttpRequest({state:"error",req:e,context:a,error:p}),u(()=>p)}))}function ft(e,o){let t=i(c),r=t.getContextFromRequest(e);return t.addOrUdpateHttpRequest({state:"loading",req:e,context:r}),o(e).pipe(O(()=>t.addOrUdpateHttpRequest({state:"complete",req:e,context:r})))}var vt={providers:[L(()=>{let e=i(R);return w(e.load())}),V($(),Y([ut,dt,ft])),B({eventCoalescing:!0}),et(mt,ot())]};function Ht(e,o){e&1&&(s(0,"div",0)(1,"div",1),f(2,"span",2)(3,"shared-image",3),m()())}var y=class e{_interceptorService=i(c);_socketService=i(ct);isLoading=W(()=>this._interceptorService.dataHttpRequests().some(o=>o.state==="loading"&&o.context.actionsWhileLoadingHttpRequest?.includes("spinner"))||this._socketService.counter()!==0);static \u0275fac=function(t){return new(t||e)};static \u0275cmp=d({type:e,selectors:[["core-spinner"]],decls:1,vars:1,consts:[[1,"d-flex","justify-content-center","align-items-center","vw-100","vh-100","position-fixed","z-6"],["role","status",1,"spinner-border","border-0",2,"width","8rem","height","8rem"],[1,"visually-hidden"],["url","static/img/spinner.png"]],template:function(t,r){t&1&&U(0,Ht,4,0,"div",0),t&2&&G(r.isLoading()?0:-1)},dependencies:[st],styles:[".spinner-grow[_ngcontent-%COMP%]{background-color:transparent}.spinner-border[_ngcontent-%COMP%]{animation-duration:2s}"]})};var I=class e{static \u0275fac=function(t){return new(t||e)};static \u0275cmp=d({type:e,selectors:[["app-root"]],decls:2,vars:0,template:function(t,r){t&1&&f(0,"core-spinner")(1,"router-outlet")},dependencies:[Z,tt,rt,y],encapsulation:2})};J(I,vt).catch(e=>console.error(e));
